const MILLENNIUM_IS_CLIENT_MODULE=!1,pluginName="steam-app-adder";function InitializePlugins(){var e,n;let t;(e=window.PLUGIN_LIST||(window.PLUGIN_LIST={}))[pluginName]||(e[pluginName]={}),(n=window.MILLENNIUM_PLUGIN_SETTINGS_STORE||(window.MILLENNIUM_PLUGIN_SETTINGS_STORE={}))[pluginName]||(n[pluginName]={}),window.MILLENNIUM_SIDEBAR_NAVIGATION_PANELS||(window.MILLENNIUM_SIDEBAR_NAVIGATION_PANELS={}),function(e){e[e.CallServerMethod=0]="CallServerMethod"}(t||(t={}));let i=window.MILLENNIUM_PLUGIN_SETTINGS_STORE[pluginName],o=`Millennium.Internal.IPC.[${pluginName}]`;const r={DropDown:["string","number","boolean"],NumberTextInput:["number"],StringTextInput:["string"],FloatTextInput:["number"],CheckBox:["boolean"],NumberSlider:["number"],FloatSlider:["number"]};i.ignoreProxyFlag=!1,async function(){let e=null;e=setInterval(()=>{"undefined"!=typeof SteamClient&&(e&&(clearInterval(e),e=null),SteamClient.BrowserView?.RegisterForMessageFromParent((e,n)=>{if(e!==o)return;const t=JSON.parse(n);i.ignoreProxyFlag=!0,i.settingsStore[t.name]=t.value,i.ignoreProxyFlag=!1}))},100),setTimeout(()=>{e&&(clearInterval(e),console.warn("%c Millennium %c Failed to find SteamClient after 10000ms","background:rgb(37, 105, 184); color: white;","background: transparent;"))},1e4)}();const a=e=>new Proxy(e,{set(e,n,t){if(!(n in e))throw new TypeError(`Property ${String(n)} does not exist on plugin settings`);const a=r[e[n].type],l=e[n]?.range;if(a.includes("number")&&"number"==typeof t&&(l&&(t=function(e,n,t){return Math.max(n,Math.min(t,e))}(t,l[0],l[1])),t||(t=0)),!a.includes(typeof t))throw new TypeError(`Expected ${a.join(" or ")}, got ${typeof t}`);return e[n].value=t,((e,n)=>{i.ignoreProxyFlag||SteamClient.BrowserView.PostMessageToParent(o,JSON.stringify({name:e,value:n}))})(String(n),t),!0},get:(e,n)=>"__raw_get_internals__"===n?e:n in e?e[n].value:void 0});i.DefinePluginSetting=a,i.settingsStore=a({})}InitializePlugins();const __call_server_method__=(e,n)=>Millennium.callServerMethod(pluginName,e,n),__wrapped_callable__=e=>MILLENNIUM_API.callable(__call_server_method__,e);let PluginEntryPointMain=function(){return function(e){"use strict";const n=__wrapped_callable__("Backend.receive_frontend_message"),t=__wrapped_callable__("Backend.restart");return e.default=function(){if(!/^https:\/\/store\.steampowered\.com\/app\//.test(location.href))return;const e="add-app-to-library-btn",i=async()=>{try{const i=await((e,n=2e4)=>new Promise((t,i)=>{const o=document.querySelector(e);if(o)return t(o);const r=new MutationObserver(()=>{const n=document.querySelector(e);n&&(r.disconnect(),t(n))});r.observe(document.documentElement,{childList:!0,subtree:!0}),setTimeout(()=>{r.disconnect(),i(new Error("timeout"))},n)}))(".apphub_OtherSiteInfo");if(document.getElementById(e))return;const o=document.createElement("button");o.id=e,o.type="button",o.style.marginRight="3px",o.className="btnv6_blue_hoverfade btn_medium",o.innerHTML="<span>Add to library</span>",o.addEventListener("click",async e=>{e.preventDefault();try{await n({message:window.location.href})?window.confirm("The app was successfully added! Do you want to restart now?")&&await t():alert("The app was not added!")}catch(e){alert(e?.response??e)}});const r=i.lastElementChild;r?i.insertBefore(o,r):i.appendChild(o)}catch{setTimeout(i,1e3)}};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",i,{once:!0}):i(),new MutationObserver(()=>{document.getElementById(e)||i()}).observe(document.body,{childList:!0,subtree:!0})},Object.defineProperty(e,"__esModule",{value:!0}),e}({},window.MILLENNIUM_API)};function ExecutePluginModule(){let e=window.MILLENNIUM_PLUGIN_SETTINGS_STORE[pluginName];e.OnPluginConfigChange=function(n,t,i){n in e.settingsStore&&(e.ignoreProxyFlag=!0,e.settingsStore[n]=i,e.ignoreProxyFlag=!1)},MILLENNIUM_BACKEND_IPC.postMessage(0,{pluginName:pluginName,methodName:"__builtins__.__millennium_plugin_settings_parser__"}).then(async n=>{"string"==typeof n.returnValue&&(e.ignoreProxyFlag=!0,e.settingsStore=e.DefinePluginSetting(Object.fromEntries(JSON.parse(atob(n.returnValue)).map(e=>[e.functionName,e]))),e.ignoreProxyFlag=!1);let t=PluginEntryPointMain();Object.assign(window.PLUGIN_LIST[pluginName],{...t,__millennium_internal_plugin_name_do_not_use_or_change__:pluginName});let i=await t.default();var o;i&&(o=i)&&void 0!==o.title&&void 0!==o.icon&&void 0!==o.content?window.MILLENNIUM_SIDEBAR_NAVIGATION_PANELS[pluginName]=i:console.warn(`Plugin ${pluginName} does not contain proper SidebarNavigation props and therefor can't be mounted by Millennium. Please ensure it has a title, icon, and content.`)})}ExecutePluginModule();